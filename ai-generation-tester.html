<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–µ—Ä AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ API —Ç–µ—Å—Ç–æ–≤</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f8fafc;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; margin-bottom: 30px; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; }
        .api-card { 
            background: white; 
            border-radius: 12px; 
            padding: 20px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        .api-title { 
            font-size: 18px; 
            font-weight: 600; 
            margin-bottom: 8px; 
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .api-description { 
            color: #64748b; 
            margin-bottom: 15px; 
            font-size: 14px;
        }
        .test-prompts {
            background: #f1f5f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .test-prompts h4 {
            margin: 0 0 8px 0;
            font-size: 14px;
            color: #374151;
        }
        .prompt-item {
            background: white;
            padding: 8px 12px;
            margin: 4px 0;
            border-radius: 6px;
            font-size: 13px;
            border: 1px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
        }
        .prompt-item:hover {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        .expected-features {
            margin-bottom: 15px;
        }
        .feature-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 8px;
        }
        .feature-tag {
            background: #dbeafe;
            color: #1d4ed8;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        .test-btn { 
            background: #3b82f6; 
            color: white; 
            border: none; 
            padding: 10px 16px; 
            border-radius: 6px; 
            cursor: pointer; 
            font-size: 14px;
            width: 100%;
            margin-bottom: 10px;
        }
        .test-btn:hover { background: #2563eb; }
        .test-btn:disabled { background: #9ca3af; cursor: not-allowed; }
        .result-area {
            margin-top: 15px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            min-height: 100px;
            font-size: 12px;
            white-space: pre-wrap;
            display: none;
        }
        .result-area.show { display: block; }
        .result-area.loading { 
            background: #dbeafe; 
            border-color: #3b82f6;
            color: #1d4ed8;
        }
        .result-area.success { 
            background: #f0fdf4; 
            border-color: #22c55e;
            color: #166534;
        }
        .result-area.error { 
            background: #fef2f2; 
            border-color: #ef4444;
            color: #dc2626;
        }
        .stats {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .stat-item {
            padding: 10px;
            background: #f8fafc;
            border-radius: 8px;
        }
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1e293b;
        }
        .stat-label {
            font-size: 12px;
            color: #64748b;
            margin-top: 4px;
        }
        .instructions {
            background: #fffbeb;
            border: 1px solid #fbbf24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .instructions h3 {
            margin: 0 0 10px 0;
            color: #92400e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ –¢–µ—Å—Ç–µ—Ä AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ API —Ç–µ—Å—Ç–æ–≤</h1>
            <p>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∫ –ò–ò –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ API</p>
        </div>

        <div class="instructions">
            <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:</h3>
            <ol>
                <li><strong>–í—ã–±–µ—Ä–∏—Ç–µ API</strong> –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–∏–∂–µ</li>
                <li><strong>–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–æ–º–ø—Ç</strong> —á—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é</li>
                <li><strong>–û—Ü–µ–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</strong> —Å–æ–∑–¥–∞–ª –ª–∏ AI –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã?</li>
                <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–∫—Ä—ã—Ç–∏–µ:</strong> –≤—Å–µ –ª–∏ –≤–∞–∂–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤–∫–ª—é—á–µ–Ω—ã?</li>
            </ol>
        </div>

        <div class="stats">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="total-tests">0</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="successful-generations">0</div>
                    <div class="stat-label">–£—Å–ø–µ—à–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="failed-generations">0</div>
                    <div class="stat-label">–ù–µ—É–¥–∞—á–Ω—ã—Ö</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="avg-tests-per-api">0</div>
                    <div class="stat-label">–¢–µ—Å—Ç–æ–≤ –Ω–∞ API</div>
                </div>
            </div>
        </div>

        <div class="test-grid" id="api-grid">
            <!-- API –∫–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </div>

    <script>
        let totalTests = 0;
        let successfulGenerations = 0;
        let failedGenerations = 0;
        let totalGeneratedTests = 0;

        const apis = [
            {
                name: "JSONPlaceholder",
                icon: "üìù",
                description: "–ò–¥–µ–∞–ª—å–Ω—ã–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è CRUD –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö",
                baseUrl: "https://jsonplaceholder.typicode.com",
                prompts: [
                    "JSONPlaceholder API –¥–ª—è –ø–æ—Å—Ç–æ–≤ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",
                    "Fake REST API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è CRUD",
                    "JSONPlaceholder posts users comments albums"
                ],
                expectedFeatures: ["CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏", "–°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è", "–ü–∞–≥–∏–Ω–∞—Ü–∏—è"]
            },
            {
                name: "ReqRes",
                icon: "üîê",
                description: "–û—Ç–ª–∏—á–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–≤",
                baseUrl: "https://reqres.in/api",
                prompts: [
                    "ReqRes API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏",
                    "ReqRes fake users registration login",
                    "ReqRes API with delayed responses"
                ],
                expectedFeatures: ["–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è", "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è", "–ü–∞–≥–∏–Ω–∞—Ü–∏—è", "–ó–∞–¥–µ—Ä–∂–∫–∏"]
            },
            {
                name: "HTTPBin",
                icon: "üåê",
                description: "–õ—É—á—à–∏–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTTP –º–µ—Ç–æ–¥–æ–≤ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤",
                baseUrl: "https://httpbin.org",
                prompts: [
                    "HTTPBin –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è HTTP –º–µ—Ç–æ–¥–æ–≤",
                    "HTTPBin headers cookies testing service",
                    "HTTP testing with status codes"
                ],
                expectedFeatures: ["HTTP –º–µ—Ç–æ–¥—ã", "–ó–∞–≥–æ–ª–æ–≤–∫–∏", "–°—Ç–∞—Ç—É—Å –∫–æ–¥—ã", "–ö—É–∫–∏"]
            },
            {
                name: "REST Countries",
                icon: "üåç",
                description: "–ë–æ–≥–∞—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏",
                baseUrl: "https://restcountries.com/v3.1",
                prompts: [
                    "REST Countries API –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä–∞–Ω–∞—Ö",
                    "Countries data with filtering",
                    "World countries population currency"
                ],
                expectedFeatures: ["–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏", "–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è", "–°–ª–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã", "–ì–µ–æ–¥–∞–Ω–Ω—ã–µ"]
            },
            {
                name: "Random User",
                icon: "üë§",
                description: "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤",
                baseUrl: "https://randomuser.me/api",
                prompts: [
                    "Random User Generator API",
                    "Fake user data with photos",
                    "Random person generator with parameters"
                ],
                expectedFeatures: ["–°–ª–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã", "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã", "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è", "–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è"]
            },
            {
                name: "Dog API",
                icon: "üêï",
                description: "API —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–¥–∏–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞",
                baseUrl: "https://dog.ceo/api",
                prompts: [
                    "Dog API random images breeds",
                    "Dog breeds with random pictures",
                    "Random dog photos by breed"
                ],
                expectedFeatures: ["–°–ª—É—á–∞–π–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è", "–ü–æ—Ä–æ–¥—ã", "–ú–µ–¥–∏–∞ URL", "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏"]
            }
        ];

        function updateStats() {
            document.getElementById('total-tests').textContent = totalTests;
            document.getElementById('successful-generations').textContent = successfulGenerations;
            document.getElementById('failed-generations').textContent = failedGenerations;
            document.getElementById('avg-tests-per-api').textContent = 
                totalTests > 0 ? Math.round(totalGeneratedTests / totalTests) : 0;
        }

        async function testAIGeneration(apiName, prompt, cardElement) {
            const resultArea = cardElement.querySelector('.result-area');
            const testBtn = cardElement.querySelector('.test-btn');
            
            totalTests++;
            updateStats();
            
            testBtn.disabled = true;
            testBtn.textContent = '–ì–µ–Ω–µ—Ä–∏—Ä—É—é —Ç–µ—Å—Ç—ã...';
            
            resultArea.className = 'result-area show loading';
            resultArea.textContent = 'ü§ñ AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç API –∏ —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç—ã...\n\n–ü—Ä–æ–º–ø—Ç: "' + prompt + '"';
            
            try {
                // –ò–º–∏—Ç–∞—Ü–∏—è AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ (–≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ –∫ –≤–∞—à–µ–º—É AI API)
                const response = await fetch('/api/ai/analyze', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'generateExecutableTests',
                        data: { serviceName: prompt }
                    })
                });

                const data = await response.json();
                
                if (data.result) {
                    let testsData;
                    try {
                        // –ü–æ–ø—ã—Ç–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
                        if (typeof data.result === 'object') {
                            testsData = data.result;
                        } else {
                            const jsonMatch = data.result.match(/\[[\s\S]*\]/);
                            if (jsonMatch) {
                                testsData = JSON.parse(jsonMatch[0]);
                            } else {
                                testsData = JSON.parse(data.result);
                            }
                        }

                        if (Array.isArray(testsData) && testsData.length > 0) {
                            successfulGenerations++;
                            totalGeneratedTests += testsData.length;
                            
                            resultArea.className = 'result-area show success';
                            resultArea.textContent = `‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ ${testsData.length} —Ç–µ—Å—Ç–æ–≤!\n\n` +
                                `–ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤:\n` +
                                testsData.slice(0, 3).map(test => 
                                    `‚Ä¢ ${test.name} (${test.method} ${test.url})`
                                ).join('\n') +
                                (testsData.length > 3 ? `\n... –∏ –µ—â–µ ${testsData.length - 3} —Ç–µ—Å—Ç–æ–≤` : '');
                        } else {
                            throw new Error('–ü—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ —Ç–µ—Å—Ç–æ–≤');
                        }
                    } catch (parseError) {
                        failedGenerations++;
                        resultArea.className = 'result-area show error';
                        resultArea.textContent = `‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç–≤–µ—Ç–∞ AI:\n\n${parseError.message}\n\n–û—Ç–≤–µ—Ç AI:\n${data.result.substring(0, 500)}...`;
                    }
                } else {
                    failedGenerations++;
                    resultArea.className = 'result-area show error';
                    resultArea.textContent = `‚ùå AI –Ω–µ —Å–º–æ–≥ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç—ã\n\n–û—à–∏–±–∫–∞: ${data.error || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`;
                }
                
            } catch (error) {
                failedGenerations++;
                resultArea.className = 'result-area show error';
                resultArea.textContent = `‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞:\n\n${error.message}`;
            }
            
            updateStats();
            testBtn.disabled = false;
            testBtn.textContent = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é';
        }

        function createAPICard(api) {
            const card = document.createElement('div');
            card.className = 'api-card';
            
            card.innerHTML = `
                <div class="api-title">
                    <span>${api.icon}</span>
                    ${api.name}
                </div>
                <div class="api-description">${api.description}</div>
                
                <div class="test-prompts">
                    <h4>üéØ –¢–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã:</h4>
                    ${api.prompts.map(prompt => 
                        `<div class="prompt-item" onclick="testAIGeneration('${api.name}', '${prompt}', this.closest('.api-card'))">${prompt}</div>`
                    ).join('')}
                </div>
                
                <div class="expected-features">
                    <h4 style="margin: 0 0 8px 0; font-size: 14px;">üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:</h4>
                    <div class="feature-tags">
                        ${api.expectedFeatures.map(feature => 
                            `<span class="feature-tag">${feature}</span>`
                        ).join('')}
                    </div>
                </div>
                
                <button class="test-btn">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å AI –≥–µ–Ω–µ—Ä–∞—Ü–∏—é</button>
                <div class="result-area"></div>
            `;
            
            return card;
        }

        // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –≤—Å–µ—Ö API
        const grid = document.getElementById('api-grid');
        apis.forEach(api => {
            grid.appendChild(createAPICard(api));
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –∫–Ω–æ–ø–æ–∫
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('test-btn') && !e.target.disabled) {
                const card = e.target.closest('.api-card');
                const apiName = card.querySelector('.api-title').textContent.trim();
                const firstPrompt = card.querySelector('.prompt-item').textContent;
                testAIGeneration(apiName, firstPrompt, card);
            }
        });
    </script>
</body>
</html>